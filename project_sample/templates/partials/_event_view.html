{% load bootstrap_icons %}
<script type="module">
  import { createPopper } from '@popperjs/core';
  var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
  var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl)
  });

</script>
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@3.10.5/dist/fullcalendar.min.js'></script>
<div class="modal fade" id="eventViewModal" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="evenManageModalLabel">Event Occurrence</h5>
        <ul class="nav">
          <li class="nav-item">
            <button id="edit" class="nav-link active" aria-current="page" onclick="edit()" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Edit Event">{% bs_icon 'pencil' %}</button>
          </li>
          <li class="nav-item">
            <button id="email" class="nav-link active" aria-current="page" onclick="email()">{% bs_icon 'envelope' %}</button>
          </li>
          <li class="nav-item">
            <button id="delete" class="nav-link active" aria-current="page" onclick="remove()">{% bs_icon 'trash' %}</button>
          </li>
          <li class="nav-item">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
              <span>&times;</span>
            </button>
          </li>

        </ul>

      </div>

      <script>


        function edit() {
          alert("We are going to edit the thing.");
        };
        function email() {
          alert("We are going to email the thing.");

        };
        function remove() {
          if (confirm("Are you sure you want to delete this event?")) {
            $.ajaxSetup({
              headers: { "X-CSRFToken": '{{ csrf_token }}' }
            });
            $.ajax({
              type: 'DELETE',
              dataType: 'json',
              url: '{% url 'event-list'%}'+$('#event_id').val(),
              success:function(result) {
                alert("Event Deleted");
                $('#calendar').fullCalendar('refetchEvents');
              },
              error:function(xhr) {
                alert("I'm sorry but your message failed to send "  + xhr.status)
              }

            });
          }

        };

      </script>
      <div class="modal-body">
        <input type="hidden" id="id">
        <input type="hidden" id="event_id">
        <ul class="list-group">
          <li class="list-group-item" id="title"></li>
          <li class="list-group-item" id="start"></li>
          <li class="list-group-item" id="end"></li>
          <li class="list-group-item">{% bs_icon 'arrow-repeat' %}<a id='rule'>No Rule</a></li>

        </ul>
      </div>
    </div>
  </div>
</div>
